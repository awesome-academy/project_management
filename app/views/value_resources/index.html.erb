<% provide :title, t(".value_resources_index") %>
<%= render "value_resources/search" %>
<div class="card-footer">
  <% if @pagy.pages > 1 %>
    <div class="d-flex justify-content-between align-items-center">
      <!-- Pagination -->
      <%== pagy_info @pagy %>
      <%== pagy_bootstrap_nav @pagy %>
    </div>
  <% end %>
</div>
<div style="overflow-x: scroll">
  <table class="table table-striped table-hover table-bordered table-responsive position-relative value-resource-table">
    <thead>
      <tr>
        <th class="w-200px"></th>
        <% month_number_displayed(start_month_field_value(params[:start_month_year]),
                                  month_field_value(params[:end_month_year])).each do |month_year| %>
          <th colspan="3" class="w-400px"> <%= t "project_features.project_feature.month" %> <%= month_year.join("-") %> </th>
        <% end %>
        <th colspan="3" class="w-600px"><%= t ".total_year" %></th>
      </tr>
      <tr>
        <th><%= t "projects.index.name" %></th>
        <% month_number_displayed(start_month_field_value(params[:start_month_year]),
                                  month_field_value(params[:end_month_year])).each do |i| %>
          <th><%= t ".value" %></th>
          <th><%= t ".resource" %></th>
          <th><%= t ".diff" %></th>
        <% end %>
        <th>
          <%= t ".total_value_year",
                month: month_number_displayed(start_month_field_value(params[:start_month_year]),
                                              month_field_value(params[:end_month_year])).length %>
        </th>
        <th>
          <%= t ".total_resource_year",
                month: month_number_displayed(start_month_field_value(params[:start_month_year]),
                                              month_field_value(params[:end_month_year])).length %>
        </th>
        <th>
          <%= t ".total_diff_year",
                month: month_number_displayed(start_month_field_value(params[:start_month_year]),
                                              month_field_value(params[:end_month_year])).length %>
        </th>
      </tr>
    </thead>
    <tbody>
      <tr class="font-weight-bold">
        <td><%= t ".total" %></td>
        <%= value_resources_total_html @projects,
                                       start_month_field_value(params[:start_month_year]),
                                       month_field_value(params[:end_month_year]) %>
      </tr>
      <% @project_pagys.each do |project| %>
        <%= render partial: "value_resources/value_resource", locals: { project: project} %>
      <% end %>
    </tbody>
  </table>
</div>
